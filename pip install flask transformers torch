from flask import Flask, request, jsonify
from transformers import pipeline

app = Flask(__name__)

# Chargement du pipeline de paraphrase ou de style (ex. modèle T5)
# Ici, on prend un modèle pré-entraîné qui peut servir de base.
# Tu peux affiner un modèle pour un style spécifique (ex : Victor Hugo).
paraphraser = pipeline("text2text-generation", model="Vamsi/T5_Paraphrase_Paws")

@app.route("/")
def home():
    return "Bienvenue sur l'API de reformulation littéraire !"

@app.route("/reformuler", methods=["POST"])
def reformuler():
    data = request.get_json()
    texte_original = data.get("texte", "")

    if not texte_original:
        return jsonify({"error": "Aucun texte fourni"}), 400

    try:
        result = paraphraser(f"paraphrase: {texte_original} </s>", max_length=100, num_return_sequences=1)
        texte_reformule = result[0]['generated_text']
        return jsonify({
            "original": texte_original,
            "reformule": texte_reformule
        })

    except Exception as e:
        return jsonify({"error": str(e)}), 500

if __name__ == "__main__":
    app.run(debug=True)
